<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Рынок</title>
  <link rel="stylesheet" href="/static/styles.css">
</head>
<body class="dark-theme">
  <header class="header">
    <div class="header-left"><h1>Рынок P2P</h1></div>
    <div class="header-right"><button class="icon-btn" onclick="openSettings()">⚙️</button></div>
  </header>
  <div id="settings-modal" class="modal"><div class="modal-content">
    <span class="close-btn" onclick="closeSettings()">✖️</span>
    <h2>Настройки</h2>
    <p><a href="/withdraw">Вывод средств</a></p>
    <p><a href="/deposit">Пополнить сеть</a></p>
    <p>Кошелёк: <a href="#">0x123...</a></p>
  </div></div>
  <div class="container">
    <a href="/create"><button class="btn">Создать объявление</button></a>
    <div class="filters">
      <select id="f-crypto"><option>Крипта</option><option>USDT</option><option>BTC</option><option>ETH</option><option>TRUMP</option></select>
      <select id="f-fiat"><option>Фиат</option><option>RUB</option><option>USD</option><option>EUR</option></select>
      <select id="f-payment"><option>Оплата</option><option>Сбербанк</option><option>Тинькофф</option><option>PayPal</option></select>
      <button class="btn" onclick="filterAds()">Фильтровать</button>
    </div>
    <ul id="ads-list">
      {% for ad in ads %}
      <li class="ad-card">
        <p><strong>{{ad.action|capitalize}}</strong> {{ad.amount}} {{ad.crypto}} → {{ad.fiat}}</p>
        <p>Оплата: {{ad.payment_method}}</p>
        <a href="/trade/{{ad.id}}"><button class="btn">Купить</button></a>
      </li>
      {% else %}
      <li>Объявлений нет</li>
      {% endfor %}
    </ul>
  </div>
  <script>
    function openSettings(){document.getElementById('settings-modal').style.display='block';}
    function closeSettings(){document.getElementById('settings-modal').style.display='none';}
    function filterAds(){
      const c=document.getElementById('f-crypto').value;
      const f=document.getElementById('f-fiat').value;
      const p=document.getElementById('f-payment').value;
      document.querySelectorAll('.ad-card').forEach(el=>{
        el.style.display = (!c||el.innerText.includes(c))&&(!f||el.innerText.includes(f))&&(!p||el.innerText.includes(p)) ? '' : 'none';
      });
    }
  </script>
</body>
</html>
