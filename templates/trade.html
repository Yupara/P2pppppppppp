<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–°–¥–µ–ª–∫–∞ —Å {{ user.username }}</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body class="dark-theme">
    <div class="container">
        <div class="profile-header">
            <div class="avatar">{{ user.username[0] }}</div>
            <div class="user-info">
                <h2>{{ user.username }}</h2>
                <p>–≠–ª. –ø–æ—á—Ç–∞ ‚úÖ  SMS ‚úÖ  –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ª–∏—á–Ω–æ—Å—Ç–∏ ‚úÖ</p>
                <div class="badge">–û–±—ã—á–Ω—ã–π –º–µ–π–∫–µ—Ä</div>
            </div>
        </div>

        <div class="stats">
            <p><strong>{{ user.orders }}</strong> –æ—Ä–¥–µ—Ä–∞ –∑–∞ 30 –¥–Ω–µ–π</p>
            <p>–ò—Å–ø–æ–ª–Ω–µ–Ω–æ: <strong>{{ user.rate }}</strong></p>
            <p>–°—Ä–µ–¥–Ω. –≤—Ä–µ–º—è –ø–µ—Ä–µ–≤–æ–¥–∞: <strong>{{ user.avg_transfer }}</strong></p>
            <p>–°—Ä–µ–¥–Ω. –≤—Ä–µ–º—è –æ–ø–ª–∞—Ç—ã: <strong>{{ user.avg_pay }}</strong></p>
        </div>

        <hr>

        <div class="actions">
            <button>üí≥ –°–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã</button>
            <button>üìû –ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</button>
            <button>üí¨ –û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</button>
            <button>üîï –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</button>
            <button>üì• –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è</button>
            <button>üö´ –ß—ë—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫</button>
        </div>
    </div>
</body>
</html>

<!-- templates/trade.html -->
{% extends "base.html" %}

{% block content %}
<div class="trade-box">
  <h2>–°–¥–µ–ª–∫–∞ #{{ trade.id }}</h2>

  <div class="trade-info">
    <p>–°—É–º–º–∞: {{ trade.amount }} USDT</p>
    <p>–¶–µ–Ω–∞: {{ trade.price }} {{ trade.fiat_currency }}</p>
    <p>–ú–µ—Ç–æ–¥ –æ–ø–ª–∞—Ç—ã: {{ trade.payment_method }}</p>
  </div>

  <div id="timer">–û—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è: <span id="countdown">--:--</span></div>

  <div class="trade-actions">
    <button onclick="markPaid()">–Ø –æ–ø–ª–∞—Ç–∏–ª</button>
    <button onclick="confirmReceived()">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ</button>
    <button onclick="openDispute()">–û—Ç–∫—Ä—ã—Ç—å —Å–ø–æ—Ä</button>
  </div>

  <div class="chat-box">
    <h3>–ß–∞—Ç</h3>
    <div id="messages"></div>
    <input type="text" id="chat-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
    <button onclick="sendMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
  </div>
</div>

<script>
  let timeLeft = 30 * 60; // 30 –º–∏–Ω—É—Ç
  const countdown = document.getElementById("countdown");

  function updateTimer() {
    const minutes = Math.floor(timeLeft / 60);
    const seconds = timeLeft % 60;
    countdown.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
    if (timeLeft > 0) timeLeft--;
  }

  setInterval(updateTimer, 1000);

  function markPaid() {
    alert("–û–ø–ª–∞—Ç–∞ –æ—Ç–º–µ—á–µ–Ω–∞! (—Ç—É—Ç –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ API)");
  }

  function confirmReceived() {
    alert("–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–∏—è! (—Ç—É—Ç –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ API)");
  }

  function openDispute() {
    alert("–°–ø–æ—Ä –æ—Ç–∫—Ä—ã—Ç! (—Ç—É—Ç –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ API)");
  }

  function sendMessage() {
    const input = document.getElementById("chat-input");
    const msg = input.value;
    if (msg) {
      const box = document.getElementById("messages");
      box.innerHTML += `<div><b>–í—ã:</b> ${msg}</div>`;
      input.value = "";
      // –í –±—É–¥—É—â–µ–º ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ WebSocket
    }
  }
</script>
{% endblock %}
