{% extends "base.html" %}
{% block title %}Сделка №{{ trade.id if trade else ad.id }}{% endblock %}
{% block content %}
  <h1>Сделка с объявлением #{{ ad.id }}</h1>

  {% if not order %}
  <form action="/orders/create/{{ ad.id }}" method="post" class="form">
    <label>Криптовалюта:</label>
    <select name="crypto" required>
      {% for c in cryptos %}
        <option value="{{ c }}" {% if c == ad.crypto %}selected{% endif %}>{{ c }}</option>
      {% endfor %}
    </select>

    <label>Фиат:</label>
    <select name="fiat" required>
      {% for f in fiats %}
        <option value="{{ f }}" {% if f == ad.fiat %}selected{% endif %}>{{ f }}</option>
      {% endfor %}
    </select>

    <label>Сумма ({{ ad.crypto }}):</label>
    <input type="number" step="0.0001" name="amount" placeholder="{{ ad.min_limit }}–{{ ad.max_limit }}" 
           min="{{ ad.min_limit }}" max="{{ ad.max_limit }}" required>

    <label>Способ оплаты:</label>
    <select name="payment_method" required>
      {% for p in payments %}
        <option value="{{ p }}" {% if p in ad.payment_methods %}selected{% endif %}>{{ p }}</option>
      {% endfor %}
    </select>

    <button type="submit">Создать сделку</button>
  </form>
  {% else %}
  <!-- Здесь вывод информации уже созданной сделки -->
  {% endif %}
{% endblock %}
