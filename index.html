<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>P2P Платформа</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1>P2P Платформа</h1>

    <div class="menu">
        <button class="active" onclick="switchTab('buy')">Покупка</button>
        <button onclick="switchTab('sell')">Продажа</button>
    </div>

    <div class="filters">
        <select id="currencySelect">
            <option value="USDT">USDT</option>
            <option value="BTC">BTC</option>
        </select>
        <input type="text" placeholder="Сумма (RUB)" />
        <select>
            <option>Все способы оплаты</option>
            <option>SBP</option>
            <option>Банк</option>
        </select>
        <button>Фильтр</button>
    </div>

    <div class="cards">
        <div class="card">
            <div class="info">
                <div class="status online"></div>
                <img src="https://via.placeholder.com/50" alt="avatar" />
                <div>
                    <h3>Savak</h3>
                    <p>50 сделок • 95% успех</p>
                </div>
            </div>
            <div class="details">
                <p>Цена: ₽90.25</p>
                <p>Доступно: 1200 USDT</p>
                <p>Лимит: 1000–500000 ₽</p>
                <p>Способ: СБП</p>
            </div>
            <div class="actions">
                <button onclick="startTrade('Savak', 'USDT', '90.25', 'SBP')">Купить</button>
            </div>
        </div>
    </div>

    <script>
        function switchTab(tab) {
            alert("Вкладка '" + tab + "' выбрана. (реализуется позже)");
        }

        function startTrade(seller, currency, price, method) {
            const params = new URLSearchParams({
                seller,
                currency,
                price,
                method
            });
            window.location.href = 'trade.html?' + params.toString();
        }
    </script>
</body>
</html>

<script>
document.addEventListener("DOMContentLoaded", () => {
  fetch("/api/public_ads")
    .then(res => res.json())
    .then(data => {
      const container = document.getElementById("adsList");
      data.forEach(ad => {
        const div = document.createElement("div");
        div.className = "ad";
        div.innerHTML = `
          <p><strong>${ad.type === "buy" ? "Покупка" : "Продажа"}</strong></p>
          <p>Ник: ${ad.nickname}</p>
          <p>Цена: ${ad.price} ₽</p>
          <p>Сумма: ${ad.amount} USDT</p>
          <a href="/order.html?id=${ad.id}">
            <button>${ad.type === "buy" ? "Продать" : "Купить"}</button>
          </a>
        `;
        container.appendChild(div);
      });
    });
});
</script>
